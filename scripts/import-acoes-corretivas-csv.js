// Script para importar ações corretivas do CSV
const { Pool } = require('pg');
require('dotenv').config({ path: '.env.local' });

const pool = new Pool({
  connectionString: process.env.DATABASE_URL,
  ssl: process.env.DATABASE_URL?.includes('localhost') ? false : { rejectUnauthorized: false }
});

// Dados extraídos do CSV - REGISTRO DE AÇÃO CORRETIVA
const acoesCorretivas = [
  { numero_rac: '1', status_acoes: 'FINALIZADA', prazo: '17/07/2024', situacao_final: 'EFICAZ', data_emissao: '16/02/2024', emitente: 'DANIEL ANDERS', numero_nc: '428', processos_envolvidos: 'QUALIDADE', falha: 'Falha na identificação de peças.', causas: 'Falhas nos processos de controle de documentos, processo de identificação de peças não integrado, ausência de verificações regulares, cultura organizacional inadequada', acoes: 'Revisar processos de trabalho, implementar programa de treinamento, estabelecer cronograma de auditorias, avaliar melhorias tecnológicas, incluir nos padrões que nenhuma peça pode ser movimentada sem identificação', responsaveis: 'DANIEL ANDERS', acoes_finalizadas: 'SIM', responsavel_analise: 'DANIEL ANDERS', data_analise: '06/11/2024' },
  { numero_rac: '2', status_acoes: 'FINALIZADA', prazo: '18/07/2024', situacao_final: 'EFICAZ', data_emissao: '16/04/2024', emitente: 'DANIEL ANDERS', numero_nc: '427', processos_envolvidos: 'QUALIDADE', falha: 'Falhas na sistemática de tratamento de não conformidades.', causas: 'Falta de ferramentas adequadas para análise de causas raízes, procedimentos inadequados, treinamento insuficiente', acoes: 'Desenvolver programa de treinamento sobre ferramentas analíticas, implementar auditorias regulares, estabelecer política de desenvolvimento profissional contínuo', responsaveis: 'DANIEL ANDERS', acoes_finalizadas: 'SIM', responsavel_analise: 'DANIEL ANDERS', data_analise: '06/11/2024' },
  { numero_rac: '3', status_acoes: 'FINALIZADA', prazo: '17/07/2024', situacao_final: 'EFICAZ', data_emissao: '16/04/2024', emitente: 'DANIEL ANDERS', numero_nc: '429', processos_envolvidos: 'QUALIDADE', falha: 'Falha no planejamento e sistemática de gestão de mudanças que impactam no sistema de gestão da qualidade', causas: 'Instalação de equipamentos sem avaliação adequada, falta de metodologias para avaliar impacto, processos mal definidos, falta de treinamento', acoes: 'Desenvolver processo de gestão de mudanças com framework robusto, implementar programas de treinamento, estabelecer sistema de auditorias regulares, promover cultura de gestão de mudanças', responsaveis: 'DANIEL ANDERS', acoes_finalizadas: 'SIM', responsavel_analise: 'DANIEL ANDERS', data_analise: '06/11/2024' },
  { numero_rac: '4', status_acoes: 'FINALIZADA', prazo: '17/07/2024', situacao_final: 'EFICAZ', data_emissao: '16/04/2024', emitente: 'DANIEL ANDERS', numero_nc: '430', processos_envolvidos: 'COMPRAS, QUALIDADE', falha: 'Falha na análise e avaliação necessários para assegurar resultados válidos.', causas: 'Métodos ineficientes de coleta de dados, ausência de procedimentos claros, dados não disponíveis, erro humano, falta de treinamento, pressões de tempo', acoes: 'Revisar processos de coleta e verificação de dados, estabelecer plano de auditorias, desenvolver programa de treinamento, investir em melhorias tecnológicas, estabelecer rotinas mensais de análise', responsaveis: 'DANIEL ANDERS', acoes_finalizadas: 'SIM', responsavel_analise: 'DANIEL ANDERS', data_analise: '06/11/2024' },
  { numero_rac: '5', status_acoes: 'FINALIZADA', prazo: '17/07/2024', situacao_final: 'EFICAZ', data_emissao: '16/04/2024', emitente: 'DANIEL ANDERS', numero_nc: '431', processos_envolvidos: 'LOGÍSTICA, QUALIDADE', falha: 'Falha na determinação da sequência e interação de processos', causas: 'Métodos de documentação inadequados, ausência de procedimentos padrões, falta de treinamento, falha na utilização de dados, cultura organizacional inadequada', acoes: 'Estabelecer política de revisões periódicas e auditorias internas, promover cultura de gestão da qualidade, continuar investindo em tecnologia', responsaveis: 'DANIEL ANDERS', acoes_finalizadas: 'SIM', responsavel_analise: 'DANIEL ANDERS', data_analise: '06/11/2024' },
  { numero_rac: '6', status_acoes: 'FINALIZADA', prazo: '08/08/2024', situacao_final: 'NÃO EFICAZ', data_emissao: '10/05/2024', emitente: 'PATRÍCIA BEAL', numero_nc: '44', processos_envolvidos: 'PRODUÇÃO', falha: 'Falha na solda identificada no teste com líquido penetrante, mostrando vários pontos com defeito no conjunto do reservatório (código 27982).', causas: 'Técnica de solda inadequada, inspeção intermediária ausente, falta de treinamento específico', acoes: 'Definir parâmetros específicos e padronizados para soldagem, inserir etapas de inspeção ao longo do processo de soldagem', responsaveis: 'RODRIGO SBRUZZI', acoes_finalizadas: 'SIM', responsavel_analise: 'DANIEL ANDERS', data_analise: '08/09/2024' },
  { numero_rac: '7', status_acoes: 'FINALIZADA', prazo: '21/08/2024', situacao_final: 'NÃO EFICAZ', data_emissao: '03/06/2024', emitente: 'PATRÍCIA BEAL', numero_nc: '50', processos_envolvidos: 'ENGENHARIA, PRODUÇÃO, QUALIDADE', falha: 'Conjunto montado incorretamente devido a erro no desenho técnico', causas: 'Desenho técnico incorreto', acoes: 'Implementar uma revisão técnica antes da liberação de desenhos para produção', responsaveis: 'RODRIGO SBRUZZI', acoes_finalizadas: 'SIM', responsavel_analise: 'DANIEL ANDERS', data_analise: '20/09/2024' },
  { numero_rac: '8', status_acoes: 'FINALIZADA', prazo: '01/09/2024', situacao_final: 'NÃO EFICAZ', data_emissao: '03/06/2024', emitente: 'PATRÍCIA BEAL', numero_nc: '76', processos_envolvidos: 'ALMOXARIFADO', falha: 'Perfil de comprimento 2500mm coletado incorretamente, enquanto o padrão correto seria de 3000mm', causas: 'Falha na especificação do material, falta de conferência do material recebido', acoes: 'Capacitar os colaboradores para realizar a conferência dos materiais, assegurando a compatibilidade com o padrão exigido', responsaveis: 'PATRÍCIA BEAL', acoes_finalizadas: 'SIM', responsavel_analise: 'DANIEL ANDERS', data_analise: '01/10/2024' },
  { numero_rac: '9', status_acoes: 'FINALIZADA', prazo: '09/09/2024', situacao_final: 'EFICAZ', data_emissao: '11/06/2024', emitente: 'PATRÍCIA BEAL', numero_nc: '104', processos_envolvidos: 'QUALIDADE', falha: 'Tombador montado com tamanho de 2980mm no centro, enquanto o padrão correto é de 3000mm', causas: 'Falta de inspeção intermediária para controle de medidas', acoes: 'Estabelecer etapas de inspeção durante a montagem para assegurar que as medidas atendam ao padrão especificado', responsaveis: 'PATRÍCIA BEAL', acoes_finalizadas: 'SIM', responsavel_analise: 'DANIEL ANDERS', data_analise: '09/10/2024' },
  { numero_rac: '10', status_acoes: 'FINALIZADA', prazo: '15/11/2024', situacao_final: 'PARCIALMENTE EFICAZ', data_emissao: '21/06/2024', emitente: 'RICARDO FOLETTO', numero_nc: '', processos_envolvidos: 'COMERCIAL, ENGENHARIA, PRODUÇÃO, QUALIDADE', falha: 'Péssimo acabamento no coletor de amostras, incluindo ausência de furos e graxeiras de lubrificação, falhas de solda, falta de chaveta no pino da sonda e ausência de retoques na pintura', causas: 'Falta de controle de qualidade, procedimentos de montagem inadequados, falta de sistema de controle para acabamento final', acoes: 'Estabelecer inspeções específicas, desenvolver padrão de montagem e acabamento, criar processo de inspeção final', responsaveis: 'FERNANDA PONSONI E RODRIGO SBRUZZI', acoes_finalizadas: 'PARCIALMENTE', responsavel_analise: 'Fernanda Ponsoni', data_analise: '03/03/2025' },
  { numero_rac: '11', status_acoes: 'FINALIZADA', prazo: '22/09/2024', situacao_final: 'EFICAZ', data_emissao: '24/06/2024', emitente: 'PATRÍCIA BEAL', numero_nc: '142', processos_envolvidos: 'ENGENHARIA', falha: 'Ausência do projeto do desenho da central hidráulica', causas: 'Falta de controle sobre o envio de documentos essenciais para a produção', acoes: 'Implementar um procedimento que exija confirmação de todos os projetos antes do início da produção', responsaveis: 'RODRIGO SBRUZZI', acoes_finalizadas: 'SIM', responsavel_analise: 'DANIEL ANDERS', data_analise: '22/10/2024' },
  { numero_rac: '12', status_acoes: 'FINALIZADA', prazo: '15/11/2024', situacao_final: 'NÃO EFICAZ', data_emissao: '29/06/2024', emitente: 'RICARDO FOLETTO', numero_nc: '', processos_envolvidos: 'ENGENHARIA, PRODUÇÃO, COMPRAS, QUALIDADE', falha: 'Cilindro de elevação não aciona devido ao desprendimento do êmbolo da haste por falta de travamento', causas: 'Falta de travamento adequado do êmbolo, procedimentos de montagem incompletos, falha no monitoramento', acoes: 'Revisar instruções de montagem, estabelecer cronograma de manutenção preventiva', responsaveis: 'FERNANDA PONSONI', acoes_finalizadas: '', responsavel_analise: '', data_analise: '' },
  { numero_rac: '13', status_acoes: 'FINALIZADA', prazo: '17/11/2024', situacao_final: 'NÃO EFICAZ', data_emissao: '19/08/2024', emitente: 'PATRÍCIA BEAL', numero_nc: '251', processos_envolvidos: 'ENGENHARIA, QUALIDADE', falha: 'Solda do trava roda realizada com má qualidade, apesar da ação corretiva anterior.', causas: 'Insuficiência na revisão e padronização dos parâmetros de soldagem, falhas na inspeção de qualidade', acoes: 'Realizar inspeções frequentes e mais rigorosas durante o processo de soldagem, fornecer treinamento adicional focado em práticas de soldagem de alta qualidade', responsaveis: 'FERNANDA PONSONI', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '03/03/2025' },
  { numero_rac: '14', status_acoes: 'FINALIZADAS', prazo: '30/01/2025', situacao_final: 'NÃO EFICAZ', data_emissao: '12/09/2024', emitente: 'RICARDO FOLETTO', numero_nc: '', processos_envolvidos: 'COMERCIAL, ENGENHARIA', falha: 'Projeto elétrico e painel elétrico dos tombadores considerados amadores e fora das normas, com dificuldade de acesso e não operacionalidade', causas: 'Falta de controle de qualidade no projeto elétrico, especificações inadequadas, falta de treinamento', acoes: 'Desenvolver processo de validação rigoroso, revisar especificações dos painéis elétricos, realizar treinamentos periódicos', responsaveis: 'HENRIQUE RADAELLI E GIOVANI PILI', acoes_finalizadas: 'NÃO', responsavel_analise: 'FERNANDA PONSONI', data_analise: '22/05/2025' },
  { numero_rac: '15', status_acoes: 'FINALIZADA', prazo: '30/12/2025', situacao_final: 'EFICAZ', data_emissao: '01/11/2024', emitente: 'Rosilei Tomelero', numero_nc: '426', processos_envolvidos: 'ENGENHARIA, PRODUÇÃO, QUALIDADE', falha: 'Falta de Piso na Montagem', causas: 'Erro de sequência na montagem, falta de instruções específicas por posição, falha na inspeção intermediária', acoes: 'Atualizar documentos de instrução de trabalho, estabelecer pontos de verificação intermediários, realizar treinamento', responsaveis: 'Fernanda Ponsoni', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '03/03/2025' },
  { numero_rac: '16', status_acoes: 'ATRASADA', prazo: '30/01/2025', situacao_final: '', data_emissao: '01/11/2024', emitente: 'DANIEL ANDERS', numero_nc: '432', processos_envolvidos: 'QUALIDADE', falha: 'ANÁLISE CRÍTICA DA PROPOSTA NÚMERO 598 NÃO FOI REALIZADA', causas: 'Falha no processo de controle de aprovação de propostas', acoes: 'Estabelecer uma etapa obrigatória de verificação para garantir que todas as propostas passem pela análise crítica antes da geração de pedidos', responsaveis: 'DANIEL ANDERS', acoes_finalizadas: '', responsavel_analise: '', data_analise: '' },
  { numero_rac: '17', status_acoes: 'ATRASADA', prazo: '30/01/2025', situacao_final: '', data_emissao: '01/11/2024', emitente: 'DANIEL ANDERS', numero_nc: '433', processos_envolvidos: 'QUALIDADE', falha: 'Falta de registros de validação do protótipo do projeto do coletor de grão longitudinal', causas: 'Falha no processo de documentação e retenção de registros de validação, falta de controle sobre as validações', acoes: 'Implementar procedimento de armazenamento de registros, criar sistema de controle, capacitar equipe', responsaveis: 'DANIEL ANDERS', acoes_finalizadas: '', responsavel_analise: '', data_analise: '' },
  { numero_rac: '18', status_acoes: 'FINALIZADA', prazo: '30/01/2025', situacao_final: 'EFICAZ', data_emissao: '01/11/2024', emitente: 'DANIEL ANDERS', numero_nc: '434', processos_envolvidos: 'QUALIDADE', falha: 'Uso de uma trena não identificada e sem verificação/calibração para monitoramento das especificações na montagem de viga e esquadro', causas: 'Falta de controle sobre os dispositivos de medição, falha na conscientização dos operadores', acoes: 'Estabelecer procedimento que assegure dispositivos calibrados, realizar auditorias regulares, capacitar equipe', responsaveis: 'FERNANDA PONSONI', acoes_finalizadas: 'SIM', responsavel_analise: '', data_analise: '' },
  { numero_rac: '19', status_acoes: 'ATRASADA', prazo: '30/01/2025', situacao_final: '', data_emissao: '01/11/2024', emitente: 'DANIEL ANDERS', numero_nc: '435', processos_envolvidos: 'QUALIDADE', falha: 'Atividade de montagem do calço mecânico realizada sem informações ou especificações sobre o resultado esperado', causas: 'Falta de documentação técnica disponível, falha de comunicação entre setores', acoes: 'Estabelecer processo para garantir documentos acessíveis, desenvolver canal formal de comunicação, capacitar equipe', responsaveis: 'RODRIGO SBRUZZI,DANIEL ANDERS', acoes_finalizadas: '', responsavel_analise: '', data_analise: '' },
  { numero_rac: '20', status_acoes: 'FINALIZADAS', prazo: '30/01/2025', situacao_final: 'PARCIALMENTE EFICAZ', data_emissao: '01/11/2024', emitente: 'DANIEL ANDERS', numero_nc: '438', processos_envolvidos: 'QUALIDADE', falha: 'Desenho utilizado para montagem elétrica do inclinostato estava rasurado e sem controle de revisão', causas: 'Falta de sistema de controle de revisões, falta de conscientização sobre uso de desenhos não danificados', acoes: 'Estabelecer processo de revisão e controle de desenhos, realizar inspeção para recolher desenhos rasurados, capacitar equipe', responsaveis: 'FERNANDA PONSONI', acoes_finalizadas: 'PARCIALMENTE', responsavel_analise: 'Fernanda Ponsoni', data_analise: '12/05/2025' },
  { numero_rac: '21', status_acoes: 'ATRASADA', prazo: '30/01/2025', situacao_final: '', data_emissao: '01/11/2024', emitente: 'DANIEL ANDERS', numero_nc: '439', processos_envolvidos: 'QUALIDADE', falha: 'Inspeções de entrada não realizadas nos pedidos de compra 1398 e 1565.', causas: 'Falha no processo de inspeção de entrada, falta de monitoramento e controle', acoes: 'Estabelecer processo de inspeção de todos os pedidos, desenvolver sistema de monitoramento, capacitar equipe', responsaveis: 'DANIEL ANDERS', acoes_finalizadas: '', responsavel_analise: '', data_analise: '' },
  { numero_rac: '22', status_acoes: 'FINALIZADA', prazo: '15/11/2024', situacao_final: 'EFICAZ', data_emissao: '12/08/2024', emitente: 'DANIEL ANDERS', numero_nc: '243, 593, 594', processos_envolvidos: 'PRODUÇÃO', falha: 'Vigas encontradas com comprimento inferior ao especificado, variando entre 4710mm e 4790mm, enquanto a medida correta é 4770mm', causas: 'Falha no processo de corte, falta de verificação intermediária, falha de comunicação das especificações', acoes: 'Realizar verificações intermediárias, estabelecer verificação de medidas, treinar equipe de produção', responsaveis: 'DANIEL ANDERS', acoes_finalizadas: 'SIM', responsavel_analise: 'FERNANDA PONSONI', data_analise: '22/09/2025' },
  { numero_rac: '23', status_acoes: 'FINALIZADA', prazo: '31/12/2024', situacao_final: 'NÃO EFICAZ', data_emissao: '19/11/2024', emitente: 'FERNANDA PONSONI', numero_nc: '442', processos_envolvidos: 'ENGENHARIA, PRODUÇÃO, QUALIDADE', falha: 'Solda de emendas de viga irregular', causas: 'Solda realizada fora dos parâmetros, soldador novo na função', acoes: 'Treinar soldadores', responsaveis: 'DANIEL ANDERS', acoes_finalizadas: 'SIM', responsavel_analise: 'FERNANDA PONSONI', data_analise: '15/07/2025' },
  { numero_rac: '24', status_acoes: 'FINALIZADA', prazo: '30/01/2025', situacao_final: 'EFICAZ', data_emissao: '17/12/2024', emitente: 'Fernanda Ponsoni', numero_nc: '448', processos_envolvidos: 'ENGENHARIA, PRODUÇÃO, QUALIDADE', falha: 'A tampa do trava roda foi montada de forma invertida', causas: 'Não há dispositivo que garanta montagem correta, tampa direita e esquerda possuem mesmo formato', acoes: 'Construir um dispositivo a prova de erros de montagem (código da peça número 23698)', responsaveis: 'Rodrigo Sbruzzi', acoes_finalizadas: 'NÃO APROVADO O DISPOSITIVO', responsavel_analise: 'FERNANDA PONSONI', data_analise: '05/03/2025' },
  { numero_rac: '25', status_acoes: 'FINALIZADA', prazo: '03/03/2025', situacao_final: 'NÃO EFICAZ', data_emissao: '17/12/2024', emitente: 'Fernanda Ponsoni', numero_nc: '458, 530', processos_envolvidos: 'ENGENHARIA, PRODUÇÃO, QUALIDADE, RECURSOS HUMANOS', falha: 'Falta de solda nos conjuntos dos braços da parte superior na plataforma', causas: 'Falta de instrução operacional, desenhos técnicos não especificam localização dos pontos de solda', acoes: 'Elaborar instruções operacionais, ajustar máquina de corte, avaliar contratação de soldadores, avaliar curso de solda mig', responsaveis: 'Rodrigo Sbruzzi; Giovani Pili; Laura Pili', acoes_finalizadas: 'FALTA ELABORAÇÃO DA INSTRUÇÃO', responsavel_analise: 'FERNANDA PONSONI', data_analise: '15/07/2025' },
  { numero_rac: '26', status_acoes: 'FINALIZADA', prazo: '30/12/2024', situacao_final: 'NÃO EFICAZ', data_emissao: '17/12/2024', emitente: 'Fernanda Ponsoni', numero_nc: '485', processos_envolvidos: 'ENGENHARIA, PRODUÇÃO, QUALIDADE', falha: 'Conjunto do trava rodas montado fora de esquadro, com desvio de aproximadamente 35 mm', causas: 'Não há gabarito para montagem do trava rodas', acoes: 'Desenhar gabarito, cortar peças para montagem, montar gabarito, catalogar gabarito', responsaveis: 'Rodrigo Sbruzzi; Douglas Pulter; Fernando da Cruz; Fernanda Ponsoni', acoes_finalizadas: 'NÃO APROVADO O PROJETO DO GABARITO', responsavel_analise: 'FERNANDA PONSONI', data_analise: '05/03/2025' },
  { numero_rac: '27', status_acoes: 'EM ANDAMENTO', prazo: '13/02/2026', situacao_final: '', data_emissao: '17/12/2024', emitente: 'Fernanda Ponsoni', numero_nc: '489', processos_envolvidos: 'PRODUÇÃO, COMPRAS, ALMOXARIFADO, QUALIDADE', falha: 'Peças cortadas com a espessura de 4,75mm sendo que deveriam ser cortadas com espessura de 6,34mm', causas: 'Chapas de espessuras diferentes misturadas, operador não verifica espessura antes de posicionar', acoes: 'Organizar box por espessura, estabelecer código de cores, treinar operadores, elaborar procedimento de recebimento', responsaveis: 'Cristiano Pereira; Fernanda Ponsoni; Daniel Anders; Cristiane Bandiera', acoes_finalizadas: '', responsavel_analise: '', data_analise: '' },
  { numero_rac: '28', status_acoes: 'ATRASADA', prazo: '15/01/2025', situacao_final: '', data_emissao: '23/12/2024', emitente: 'Fernanda Ponsoni', numero_nc: '536', processos_envolvidos: 'PRODUÇÃO, QUALIDADE', falha: 'Tinta escorrida, presença de sujidades embaixo da tinta e pés das calhas com falta de tinta', causas: 'Pintor não seguiu instruções e procedimentos, antecipação da expedição da OPD', acoes: 'Explicar impactos das falhas para responsáveis da pintura, revisar checklist de preparação da superfície', responsaveis: 'Daniel Anders', acoes_finalizadas: '', responsavel_analise: '', data_analise: '' },
  { numero_rac: '29', status_acoes: 'FINALIZADAS', prazo: '28/03/2025', situacao_final: 'PARCIALMENTE EFICAZ', data_emissao: '23/12/2024', emitente: 'Fernanda Ponsoni', numero_nc: '542', processos_envolvidos: 'PRODUÇÃO, LOGÍSTICA, QUALIDADE', falha: 'Falta de usinagem nas furações', causas: 'Peças sem identificação adequada, falta de orientação sobre local correto, início de operação sem ordem de corte', acoes: 'Treinar operador e supervisor, estudar método para melhorar gestão de programação de produção', responsaveis: 'Fernanda Ponsoni', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '25/06/2025' },
  { numero_rac: '30', status_acoes: 'FINALIZADA', prazo: '31/01/2025', situacao_final: 'EFICAZ', data_emissao: '30/12/2024', emitente: 'Fernanda Ponsoni', numero_nc: '549', processos_envolvidos: 'ENGENHARIA, PRODUÇÃO', falha: 'Batente do trava rodas fora de posição', causas: 'Mão francesa posicionada e soldada em local incorreto', acoes: 'Incluir no desenho as especificações da posição da mão francesa', responsaveis: 'Rodrigo Sbruzzi', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '03/03/2025' },
  { numero_rac: '31', status_acoes: 'FINALIZADA', prazo: '30/01/2025', situacao_final: 'EFICAZ', data_emissao: '30/12/2024', emitente: 'Fernanda Ponsoni', numero_nc: '550', processos_envolvidos: 'PRODUÇÃO', falha: 'Corte na viga para aliviar a tensão da chapa piso', causas: 'Falha do operador do corte da chapa piso', acoes: 'Alterado momento de colocação do piso, orientar colaborador sobre tombos da plataforma', responsaveis: 'MATHEUS E FERNANDO', acoes_finalizadas: 'SIM', responsavel_analise: 'FERNANDA PONSONI', data_analise: '15/07/2025' },
  { numero_rac: '32', status_acoes: 'FINALIZADAS', prazo: '30/01/2025', situacao_final: 'PARCIALMENTE EFICAZ', data_emissao: '30/12/2024', emitente: 'Fernanda Ponsoni', numero_nc: '551', processos_envolvidos: 'PRODUÇÃO', falha: 'Desplacamento de tinta', causas: 'Aplicação de catalisador na plataforma no lugar do fosfatizante', acoes: 'Estabelecer rotina para contratação de terceiros, posterior treinamento sobre procedimentos internos', responsaveis: 'Cristiane Bandiero', acoes_finalizadas: 'PARCIALMENTE', responsavel_analise: 'Fernanda Ponsoni', data_analise: '21/03/2025' },
  { numero_rac: '33', status_acoes: 'FINALIZADAS', prazo: '31/01/2025', situacao_final: 'NÃO EFICAZ', data_emissao: '14/01/2025', emitente: 'FERNANDA PONSONI', numero_nc: '554; 555', processos_envolvidos: 'PRODUÇÃO, QUALIDADE', falha: 'PEÇAS COM EXCESSO DE REBARBAR; PEÇAS SEM FURAÇÃO', causas: 'NÃO HÁ UMA INSTRUÇÃO CLARA DE COMO O EQUIPAMENTO DEVE SER OPERADO', acoes: 'CONSTRUIR INSTRUÇÃO DE OPERAÇÃO DO EQUIPAMENTO', responsaveis: 'FERNANDA PONSONI', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '04/08/2025' },
  { numero_rac: '34', status_acoes: 'FINALIZADA', prazo: '03/02/2025', situacao_final: 'NÃO EFICAZ', data_emissao: '03/02/2025', emitente: 'Fernanda Ponsoni', numero_nc: '576', processos_envolvidos: 'LOGÍSTICA', falha: 'Calhas chegaram no cliente com riscos e amaçados', causas: 'Calhas mal embaladas, falta de material para embalagem', acoes: 'Comprado mais material para embalar as calhas, madeira e manta popular para melhor embalagem', responsaveis: 'Cristiano Pereira', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '21/03/2025' },
  { numero_rac: '35', status_acoes: 'FINALIZADA', prazo: '03/02/2025', situacao_final: 'EFICAZ', data_emissao: '03/02/2025', emitente: 'Fernanda Ponsoni', numero_nc: '567', processos_envolvidos: 'ENGENHARIA', falha: 'Divergência de medidas dos olhais com os suportes das calhas, dificultando a colocação das calhas e danificando o suporte de içamento da plataforma', causas: 'Falha de projeto, falta de dupla conferência do projeto', acoes: 'Feito a correção de todos os projetos', responsaveis: 'Rodrigo Sbruzzi', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '04/02/2025' },
  { numero_rac: '36', status_acoes: 'FINALIZADAS', prazo: '17/02/2025', situacao_final: 'EFICAZ', data_emissao: '03/02/2025', emitente: 'Fernanda Ponsoni', numero_nc: '572', processos_envolvidos: 'ALMOXARIFADO', falha: 'Foi separada a peça de código 18596, quando o projeto chamava a peça de código 12087', causas: 'Erro durante a separação, armazenamento no local errado, divergência no cadastro', acoes: 'Treinar funcionários do almoxarifado, revisar local de armazenagem', responsaveis: 'Marcel Frandaloso', acoes_finalizadas: 'SIM', responsavel_analise: 'FERNANDA PONSONI', data_analise: '25/09/2025' },
  { numero_rac: '37', status_acoes: 'FINALIZADA', prazo: '05/02/2025', situacao_final: 'EFICAZ', data_emissao: '03/02/2025', emitente: 'Fernanda Ponsoni', numero_nc: '581', processos_envolvidos: 'PRODUÇÃO, QUALIDADE, RECURSOS HUMANOS', falha: 'Flanges do motor da central hidráulica com vazamento de óleo', causas: 'Ausência de vedação na montagem, falta de padrão de instalação, parafusos sem torque adequado, falta de teste de estanqueidade', acoes: 'Aplicar vedação correta, apertar parafusos com torque adequado, testar vedação, documentar procedimento, treinar equipe, solicitar contratação de inspetor', responsaveis: 'Fernanda Ponsoni, Henrique Radaeli, Laura Pili', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '13/02/2025' },
  { numero_rac: '38', status_acoes: 'FINALIZADAS', prazo: '03/03/2025', situacao_final: 'PARCIALMENTE EFICAZ', data_emissao: '10/02/2025', emitente: 'Fernanda Ponsoni', numero_nc: '582', processos_envolvidos: 'COMPRAS, QUALIDADE', falha: 'Viga torta', causas: 'Flambagem, fadiga do material, ação térmica', acoes: 'Repassado ao setor de compras para notificar o fornecedor', responsaveis: 'Cristiane Bandiera', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '21/03/2025' },
  { numero_rac: '39', status_acoes: 'FINALIZADAS', prazo: '28/02/2025', situacao_final: 'EFICAZ', data_emissao: '25/02/2025', emitente: 'Fernanda Ponsoni', numero_nc: '592', processos_envolvidos: 'ENGENHARIA', falha: 'Os cilindros que vieram da China não estão certos, pois os Desenhos dos cilindros enviados para a China para a fabricação dos mesmos não são os corretos', causas: 'Falha de projeto, falta de atenção ao fazer o projeto', acoes: 'Revisar todos os projetos dos cilindros que são enviados para fabricação na China', responsaveis: 'Nauini Pili e Giovani Pili', acoes_finalizadas: 'SIM', responsavel_analise: 'FERNANDA PONSONI', data_analise: '19/09/2025' },
  { numero_rac: '40', status_acoes: 'FINALIZADAS', prazo: '10/03/2025', situacao_final: 'EFICAZ', data_emissao: '03/03/2025', emitente: 'Fernanda Ponsoni', numero_nc: '600', processos_envolvidos: 'ENGENHARIA', falha: 'Divergência de medidas do painel com o desenho', causas: 'Erro de projeto, dimensões incorretas do suporte com o painel', acoes: 'Revisar os desenhos e corrigir as dimensões antes da fabricação, atualizar documentação e comunicar equipe', responsaveis: 'Henrique Radaeli', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '14/03/2025' },
  { numero_rac: '41', status_acoes: 'FINALIZADAS', prazo: '25/04/2025', situacao_final: 'PARCIALMENTE EFICAZ', data_emissao: '25/03/2025', emitente: 'Fernanda Ponsoni', numero_nc: '617', processos_envolvidos: 'COMPRAS', falha: 'Falta de etiqueta e chanfro', causas: 'Falha do operador, falta de treinamento adequado', acoes: 'Treinar o operador quanto a interpretação do projeto (desenho)', responsaveis: 'Gilberto Krasucki', acoes_finalizadas: 'PARCIALMENTE', responsavel_analise: 'Fernanda Ponsoni', data_analise: '04/08/2025' },
  { numero_rac: '42', status_acoes: 'FINALIZADAS', prazo: '25/04/2025', situacao_final: 'PARCIALMENTE EFICAZ', data_emissao: '25/03/2025', emitente: 'Fernanda Ponsoni', numero_nc: '623', processos_envolvidos: 'PRODUÇÃO', falha: 'Chapas cortadas maiores que a especificação do projeto', causas: 'Erro de configuração do equipamento, falha operacional', acoes: 'Regulagem do laser, treinamento do operador', responsaveis: 'Marcel Frandaloso', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '04/08/2025' },
  { numero_rac: '43', status_acoes: 'FINALIZADAS', prazo: '25/04/2025', situacao_final: 'EFICAZ', data_emissao: '25/03/2025', emitente: 'Fernanda Ponsoni', numero_nc: '626', processos_envolvidos: 'ENGENHARIA', falha: 'Erro de medidas do projeto civil', causas: 'Dimensões inconsistentes, falhas de revisão e validação, uso de escalas incorretas', acoes: 'Revisão rigorosa por profissionais experientes, conferência cruzada entre projetos', responsaveis: 'Nauini Pili e Rodrigo Sbruzzi', acoes_finalizadas: 'PARCIALMENTE', responsavel_analise: 'Fernanda Ponsoni', data_analise: '04/07/2025' },
  { numero_rac: '44', status_acoes: 'ATRASADA', prazo: '17/04/2025', situacao_final: '', data_emissao: '31/03/2025', emitente: 'Fernanda Ponsoni', numero_nc: '628, 629 e 632', processos_envolvidos: 'PRODUÇÃO, QUALIDADE', falha: 'Falta de preenchimento dos checklist da pintura', causas: 'Cultura organizacional deficiente, falta de compreensão da importância, falta de treinamento', acoes: 'Fortalecer cultura da qualidade, implementar soluções digitais, capacitar colaboradores', responsaveis: 'Daniel Anders e Douglas Pulter', acoes_finalizadas: '', responsavel_analise: '', data_analise: '' },
  { numero_rac: '45', status_acoes: 'FINALIZADAS', prazo: '17/04/2025', situacao_final: 'NÃO EFICAZ', data_emissao: '31/03/2025', emitente: 'Fernanda Ponsoni', numero_nc: '634', processos_envolvidos: 'PRODUÇÃO', falha: 'Folga entre o flange e a bomba', causas: 'Especificações inadequadas, medida do flange maior que a bomba, superfície de contato irregular', acoes: 'Alteração da medida do corte do flange', responsaveis: 'Henrique Radaelli', acoes_finalizadas: 'NÃO', responsavel_analise: 'FERNANDA PONSONI', data_analise: '22/05/2025' },
  { numero_rac: '46', status_acoes: 'FINALIZADAS', prazo: '31/03/2025', situacao_final: 'EFICAZ', data_emissao: '31/03/2025', emitente: 'Fernanda Ponsoni', numero_nc: '635', processos_envolvidos: 'PRODUÇÃO', falha: 'Medida da tampa do ciclone menor que o orifício do projeto', causas: 'Mudança de fornecedor do ciclone, molde da rotomoldagem do fornecedor maior', acoes: 'Feito visita técnica ao fornecedor, deixado gabarito correto no fornecedor para conferência', responsaveis: 'Fernanda Ponsoni e Marcel Frandaloso', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '04/04/2025' },
  { numero_rac: '47', status_acoes: 'FINALIZADAS', prazo: '28/04/2025', situacao_final: 'EFICAZ', data_emissao: '07/04/2025', emitente: 'Fernanda Ponsoni', numero_nc: '640', processos_envolvidos: 'ALMOXARIFADO', falha: 'Peças de modelo antigo misturadas com modelo novo, as peças são de tamanhos diferentes, causam conflito com o trava pinos', causas: 'Falta de identificação adequada, armazenamento incorreto, falta de padronização, erro humano', acoes: 'Fazer verificação e separação das peças antigas, treinar colaboradores, conferir todo material na entrada e saída', responsaveis: 'Marcel Frandaloso', acoes_finalizadas: 'SIM', responsavel_analise: 'FERNANDA PONSONI', data_analise: '25/09/2025' },
  { numero_rac: '48', status_acoes: 'FINALIZADAS', prazo: '14/04/2025', situacao_final: 'EFICAZ', data_emissao: '07/04/2025', emitente: 'Fernanda Ponsoni', numero_nc: '642', processos_envolvidos: 'ENGENHARIA', falha: 'Rebaixe da bucha espaçadora maior que a espessura da chapa da lateral da coluna baixa', causas: 'Foi mudado a espessura da chapa e não foi feita a alteração do rebaixe, falha de comunicação', acoes: 'Alteração das medidas do projeto do rebaixe da bucha espaçadora', responsaveis: 'Rodrigo Sbruzzi', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '12/05/2025' },
  { numero_rac: '49', status_acoes: 'FINALIZADAS', prazo: '25/04/2005', situacao_final: 'NÃO EFICAZ', data_emissao: '07/04/2025', emitente: 'Fernanda Ponsoni', numero_nc: '645', processos_envolvidos: 'ALMOXARIFADO, QUALIDADE', falha: 'Peças vindas para UF2 com rebarba', causas: 'Foco incorreto do feixe do laser, velocidade de corte inadequada, potência mal ajustada, problema na programação', acoes: 'Verificação e ajuste dos parâmetros de corte, ajuste do foco, inspeção do bico, manutenção preventiva, treinamento', responsaveis: 'Marcel Frandaloso e Fernanda Ponsoni', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '19/08/2025' },
  { numero_rac: '50', status_acoes: 'FINALIZADAS', prazo: '24/04/2025', situacao_final: 'EFICAZ', data_emissao: '24/04/2025', emitente: 'Fernanda Ponsoni', numero_nc: '658', processos_envolvidos: 'ENGENHARIA, ALMOXARIFADO, LOGÍSTICA, QUALIDADE', falha: 'Desenhos com revisão antiga enviados para dobra', causas: 'Falta de conferência dos desenhos antes de serem enviados, falha em seguir procedimentos', acoes: 'Fazer treinamento sobre o procedimento correto, peças de dobra só aceitas se acompanhadas com desenho', responsaveis: 'Fernanda Ponsoni e Cristiane Cardoso', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '28/04/2025' },
  { numero_rac: '51', status_acoes: 'FINALIZADAS', prazo: '30/05/2025', situacao_final: 'EFICAZ', data_emissao: '13/05/2025', emitente: 'Fernanda Ponsoni', numero_nc: '670', processos_envolvidos: 'ENGENHARIA, QUALIDADE', falha: 'Chapa de saída do ciclone foi colocada invertida no fornecedor', causas: 'Erro de montagem ou posicionamento manual, falha nas instruções do fornecedor', acoes: 'Notificar fornecedor, efetuar visita técnica, criar instrução para enviar ao fornecedor, enviar gabarito', responsaveis: 'Fernanda Ponsoni e Matheus', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '26/06/2025' },
  { numero_rac: '52', status_acoes: 'FINALIZADAS', prazo: '05/06/2025', situacao_final: 'EFICAZ', data_emissao: '27/05/2025', emitente: 'Fernanda Ponsoni', numero_nc: '683 e 684', processos_envolvidos: 'PRODUÇÃO', falha: 'Folga nos olhais de articulação', causas: 'Erro de soldagem ou fixação, gabarito desalinhado, soldagem com distorção térmica', acoes: 'Revisão do gabarito de montagem, acompanhamento do alinhamento antes da solda, orientação aos soldadores', responsaveis: 'Matheus e Fernando', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '02/06/2025' },
  { numero_rac: '53', status_acoes: 'EM ANDAMENTO', prazo: '06/01/2026', situacao_final: '', data_emissao: '02/06/2025', emitente: 'Fernanda Ponsoni', numero_nc: '697', processos_envolvidos: 'PRODUÇÃO, MANUTENÇÃO', falha: 'Peças com defeitos', causas: 'Falta de manutenção preventiva, falta de regulagem correta da máquina', acoes: 'O equipamento será realocado para UF3 e será efetuada manutenção de toda a máquina de oxicorte, substituição dos bicos com mais frequência', responsaveis: 'Daniel Elzinga e Giovani Pili', acoes_finalizadas: '', responsavel_analise: '', data_analise: '' },
  { numero_rac: '54', status_acoes: 'FINALIZADAS', prazo: '04/07/2025', situacao_final: 'EFICAZ', data_emissao: '17/06/2025', emitente: 'Fernanda Ponsoni', numero_nc: '709 - 712 e 719', processos_envolvidos: 'ENGENHARIA', falha: 'Projeto da rampa do tombador menor que o especificado no projeto da estruturação', causas: 'Erro de projeto, falta de compatibilização entre os projetos', acoes: 'Implantar processo de verificação e compatibilização de projetos estruturais e mecânicos', responsaveis: 'Rodrigo Sbruzzi e Nauini Pili', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '16/07/2025' },
  { numero_rac: '55', status_acoes: 'ATRASADA', prazo: '11/07/2025', situacao_final: '', data_emissao: '24/06/2025', emitente: 'Fernanda Ponsoni', numero_nc: '742', processos_envolvidos: 'PRODUÇÃO, QUALIDADE', falha: 'Peças cortadas com espessura errada', causas: 'Plano de corte chama espessura incorreta, falha operacional', acoes: 'Revisar o programa de corte que foi usado, treinar o operador', responsaveis: 'Cristiano Pereira', acoes_finalizadas: '', responsavel_analise: '', data_analise: '' },
  { numero_rac: '56', status_acoes: 'FINALIZADAS', prazo: '11/06/2025', situacao_final: 'EFICAZ', data_emissao: '24/06/2025', emitente: 'Fernanda Ponsoni', numero_nc: '744, 745, 736, 737 e 738', processos_envolvidos: 'PRODUÇÃO, QUALIDADE', falha: 'Olhal de içamento posicionado fora das medidas do projeto, impossibilitando a montagem do braço', causas: 'Erro na montagem, falha operacional', acoes: 'Treinar os envolvidos no processo de montagem', responsaveis: 'Fernando Cruz e Matheus Alves', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '01/07/2025' },
  { numero_rac: '57', status_acoes: 'ATRASADA', prazo: '18/07/2025', situacao_final: '', data_emissao: '30/06/2025', emitente: 'Fernanda Ponsoni', numero_nc: '757, 759 e 760', processos_envolvidos: 'PRODUÇÃO', falha: 'Dobra realizada no sentido inverso ao necessário para a montagem', causas: 'Erro de programação/parâmetros, falha de comunicação/instrução', acoes: 'Reprogramar a peça com os dados corretos, treinar operadores em leitura de desenho técnico e programação', responsaveis: 'Cristiano Pereira', acoes_finalizadas: '', responsavel_analise: '', data_analise: '' },
  { numero_rac: '58', status_acoes: 'FINALIZADAS', prazo: '20/07/2025', situacao_final: 'EFICAZ', data_emissao: '14/07/2025', emitente: 'Fernanda Ponsoni', numero_nc: '782', processos_envolvidos: 'PRODUÇÃO', falha: 'Olhais de içamento com recuo no espaçamento variando entre 160mm e 170mm, com relação a cota do projeto', causas: 'Falha operacional, falta de capacitação ou treinamento, operador sem treinamento adequado', acoes: 'Reorientar os colaboradores envolvidos, refazer os treinamentos', responsaveis: 'Adriano Luiz Santos', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '04/08/2025' },
  { numero_rac: '59', status_acoes: 'FINALIZADAS', prazo: '30/07/2025', situacao_final: 'EFICAZ', data_emissao: '15/07/2025', emitente: 'Fernanda Ponsoni', numero_nc: '783', processos_envolvidos: 'ENGENHARIA, PCP', falha: 'Comprimento do fechamento (16622) maior, impossibilitando a montagem da peça no braço', causas: 'Erro no projeto, erro no plano de corte, falha no equipamento de corte', acoes: 'Revisar e corrigir o desenho técnico, validar projeto, verificar programação da máquina de corte', responsaveis: 'Rodrigo Sbruzzi; Rafael Lara', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '21/08/2025' },
  { numero_rac: '60', status_acoes: 'FINALIZADAS', prazo: '01/08/2025', situacao_final: 'EFICAZ', data_emissao: '21/07/2025', emitente: 'Fernanda Ponsoni', numero_nc: '788', processos_envolvidos: 'PRODUÇÃO', falha: 'Diâmetro do articulador impedindo a passagem do gabarito', causas: 'Usinagem fora da especificação dimensional, falha no controle do processo', acoes: 'Recalibrar instrumentos de medição, reforçar inspeção dimensional, atualizar procedimentos, treinar operadores, utilizar gabaritos de controle', responsaveis: 'Gilberto', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '19/09/2025' },
  { numero_rac: '61', status_acoes: 'FINALIZADAS', prazo: '14/11/2025', situacao_final: 'EFICAZ', data_emissao: '28/07/2025', emitente: 'Fernanda Ponsoni', numero_nc: '804 e 805', processos_envolvidos: 'PRODUÇÃO, QUALIDADE, MANUTENÇÃO', falha: 'Porosidade e falta de acabamento', causas: 'Contaminação da superfície, gás de proteção inadequado, consumíveis úmidos, parâmetros mal ajustados, técnica incorreta do soldador', acoes: 'Averiguar necessidade de calibração das máquinas, garantir limpeza adequada, ajustar parâmetros e vazão de gás, treinar operadores, armazenar eletrodos corretamente', responsaveis: 'Adriano, Matheus e Daniel', acoes_finalizadas: 'PARCIALMENTE', responsavel_analise: 'Fernanda Ponsoni', data_analise: '10/10/2025' },
  { numero_rac: '62', status_acoes: 'FINALIZADAS', prazo: '30/10/2025', situacao_final: 'EFICAZ', data_emissao: '31/07/2025', emitente: 'Fernanda Ponsoni', numero_nc: '810', processos_envolvidos: 'ENGENHARIA, PRODUÇÃO, QUALIDADE', falha: 'Solda da moldura rompeu em campo', causas: 'Erro na preparação da solda, parâmetros incorretos, defeitos na solda, falta de reforços no projeto, fatores humanos', acoes: 'Criar procedimento de soldagem (EPS/PWPS), reforçar treinamento dos soldadores, ajustar projeto com reforços, especificar critérios de avaliação no checklist', responsaveis: 'Adriano, Rodrigo, Fernanda, Matheus', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '05/11/2025' },
  { numero_rac: '63', status_acoes: 'ATRASADA', prazo: '30/08/2025', situacao_final: '', data_emissao: '12/08/2025', emitente: 'Fernanda Ponsoni', numero_nc: '821 e 825', processos_envolvidos: 'ENGENHARIA, PRODUÇÃO', falha: 'Viga apresentando variação superior a prevista no projeto', causas: 'Erro no bend allowance, springback, tolerância da largura do blank, raio de furação errado, alinhamento incorreto, força de prensa inadequada, deflexão da bancada', acoes: 'Ajustar desenvolvimento da chapa, compensar springback, melhor fixação/clamping, revisar projeto e sequência de dobras, treinar operadores', responsaveis: 'Cristiano Pereira e Rodrigo Sbruzzi', acoes_finalizadas: '', responsavel_analise: '', data_analise: '' },
  { numero_rac: '64', status_acoes: 'FINALIZADAS', prazo: '16/08/2025', situacao_final: 'EFICAZ', data_emissao: '12/08/2025', emitente: 'Fernanda Ponsoni', numero_nc: '824', processos_envolvidos: 'PRODUÇÃO', falha: 'Parafusos montados no sentido oposto ao projeto', causas: 'Falha operacional, falha na interpretação do projeto', acoes: 'Orientar o montador quanto a interpretação correta do projeto, ou na dúvida entrar em contato com a engenharia', responsaveis: 'Adriano e Matheus', acoes_finalizadas: 'SIM', responsavel_analise: 'FERNANDA PONSONI', data_analise: '25/09/2025' },
  { numero_rac: '65', status_acoes: 'FINALIZADAS', prazo: '20/08/2025', situacao_final: 'EFICAZ', data_emissao: '19/08/2025', emitente: 'Fernanda Ponsoni', numero_nc: '845', processos_envolvidos: 'ENGENHARIA', falha: 'Projeto do perfil da calha com medidas menores que o necessário', causas: 'Falha de projeto, erro humano', acoes: 'Ajustar o projeto com a medida correta', responsaveis: 'Rodrigo Sbruzzi', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '22/08/2025' },
  { numero_rac: '66', status_acoes: 'FINALIZADAS', prazo: '20/08/2025', situacao_final: 'EFICAZ', data_emissao: '19/08/2025', emitente: 'Fernanda Ponsoni', numero_nc: '827', processos_envolvidos: 'ENGENHARIA', falha: 'Furação da base do flange impedindo o acoplamento no gabarito', causas: 'Projeto com cotas menores, erro no momento da revisão do desenho', acoes: 'Ajustado a medida do desenho que estava com 150mm para 160mm', responsaveis: 'Rodrigo Sbruzzi', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '22/08/2025' },
  { numero_rac: '67', status_acoes: 'FINALIZADAS', prazo: '22/08/2025', situacao_final: 'EFICAZ', data_emissao: '20/08/2025', emitente: 'Fernanda Ponsoni', numero_nc: '829, 830, 832, 834', processos_envolvidos: 'PRODUÇÃO, MANUTENÇÃO', falha: 'Chapas apresentando rebarbas oriundas do corte', causas: 'Parâmetros de corte, falta de manutenção geral do equipamento', acoes: 'Ajustes de processo, regular velocidade de corte, ajustar potência do laser, corrigir posição do foco, verificar pressão e vazão do gás, garantir bico centralizado, realizar manutenção periódica', responsaveis: 'Cristiano Pereira e Daniel Elzinga', acoes_finalizadas: 'PARCIALMENTE', responsavel_analise: 'Fernanda Ponsoni', data_analise: '10/10/2025' },
  { numero_rac: '68', status_acoes: 'FINALIZADAS', prazo: '29/08/2025', situacao_final: 'EFICAZ', data_emissao: '26/08/2025', emitente: 'Fernanda Ponsoni', numero_nc: '850', processos_envolvidos: 'ENGENHARIA', falha: 'Divergência entre o plano de corte da etapa, gerado pela impressão de desenho obsoleto', causas: 'Erros de comunicação entre engenharia e produção, revisões de desenho não controladas', acoes: 'Atualizar a versão do projeto de montagem com o plano de corte', responsaveis: 'Rodrigo Sbruzzi', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '10/10/2025' },
  { numero_rac: '69', status_acoes: 'FINALIZADA', prazo: '26/08/2025', situacao_final: 'EFICAZ', data_emissao: '26/08/2025', emitente: 'Fernanda Ponsoni', numero_nc: '853', processos_envolvidos: 'PRODUÇÃO', falha: 'Erro na montagem do suporte dos munhões', causas: 'Falha operacional', acoes: 'Treinamento sobre interpretação de projeto', responsaveis: 'Adriano Luiz Santos', acoes_finalizadas: 'SIM', responsavel_analise: 'FERNANDA PONSONI', data_analise: '22/09/2025' },
  { numero_rac: '70', status_acoes: 'FINALIZADAS', prazo: '19/09/2025', situacao_final: '', data_emissao: '26/08/2025', emitente: 'Fernanda Ponsoni', numero_nc: '854', processos_envolvidos: 'PRODUÇÃO, QUALIDADE', falha: 'Ângulo de dobra da chapa gerando recuo e impossibilitando a montagem de chapa de fechamento lateral', causas: 'Erro de cálculo do fator K, inadequação do ferramental, variação no retorno elástico, erro de programação, falha de inspeção', acoes: 'Revisar cálculo do desenvolvimento da chapa, padronizar tabela de dobras, fazer simulação prévia, selecionar ferramental correto, executar peça piloto, aplicar controle dimensional', responsaveis: 'Cristiano Pereira e Fernanda Ponsoni', acoes_finalizadas: 'SIM', responsavel_analise: 'FERNANDA PONSONI', data_analise: '22/09/2025' },
  { numero_rac: '71', status_acoes: 'FINALIZADAS', prazo: '01/10/2025', situacao_final: 'EFICAZ', data_emissao: '01/09/2025', emitente: 'Fernanda Ponsoni', numero_nc: '862', processos_envolvidos: 'QUALIDADE', falha: 'Tombador fora de esquadro (16mm)', causas: 'Foi tirado o esquadro com a trena a laser a qual estava danificada', acoes: 'Compra de uma trena a laser para o setor da qualidade, com certificado de calibração de laboratório externo', responsaveis: 'Fernanda Ponsoni', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '19/09/2025' },
  { numero_rac: '72', status_acoes: 'FINALIZADAS', prazo: '05/09/2025', situacao_final: 'EFICAZ', data_emissao: '03/09/2025', emitente: 'Fernanda Ponsoni', numero_nc: '896', processos_envolvidos: 'ENGENHARIA, PCP', falha: 'Peça não pode ter rosca e veio com rosca', causas: 'Erro de processo de fabricação, falta do projeto da peça no setor de usinagem', acoes: 'Imprimir o projeto da peça e levar ao setor de usinagem, ajustar a OF de fabricação, retirando o processo de rosca', responsaveis: 'Rafael Lara', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '05/09/2025' },
  { numero_rac: '73', status_acoes: 'FINALIZADAS', prazo: '12/09/2025', situacao_final: 'EFICAZ', data_emissao: '10/09/2025', emitente: 'Fernanda Ponsoni', numero_nc: '903 e 904', processos_envolvidos: 'ENGENHARIA, PCP', falha: 'Plano de corte, sem o final das peças sendo assim pra poder separar as peças depois do corte somente pode ser feito com lixadeira', causas: 'Plano de corte obsoleto, falta de revisão/verificação do plano antes da execução', acoes: 'Revisão e ajuste dos planos de corte', responsaveis: 'Rafael Lara e Rodrigo Sbruzzi', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '12/09/2025' },
  { numero_rac: '74', status_acoes: 'FINALIZADAS', prazo: '10/09/2025', situacao_final: 'EFICAZ', data_emissao: '10/09/2025', emitente: 'Matheus', numero_nc: '889 e 890', processos_envolvidos: 'PRODUÇÃO', falha: 'Plataforma apresentando encurtamento de 14mm após o processo de soldagem', causas: 'Variação térmica do material, falta de travamento da plataforma, excesso de espaçamento nas emendas', acoes: 'Elaboração de travamento para a plataforma', responsaveis: 'Adriano', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni e Matheus Alves', data_analise: '10/09/2025' },
  { numero_rac: '75', status_acoes: 'FINALIZADAS', prazo: '30/09/2025', situacao_final: 'EFICAZ', data_emissao: '10/09/2025', emitente: 'Matheus', numero_nc: '902', processos_envolvidos: 'ENGENHARIA, PRODUÇÃO', falha: 'Tampa do trilho fora de medida', causas: 'Erro na leitura do desenho ou medida incorreta especificada, uso de plano de corte obsoleto', acoes: 'Revisão do projeto, exclusão de projetos obsoletos', responsaveis: 'Fernando da Cruz e Rodrigo Sbruzzi', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '24/10/2025' },
  { numero_rac: '76', status_acoes: 'FINALIZADAS', prazo: '28/11/2025', situacao_final: 'EFICAZ', data_emissao: '15/09/2025', emitente: 'Fernanda Ponsoni', numero_nc: '914', processos_envolvidos: 'PRODUÇÃO, QUALIDADE', falha: 'Afastamento da chapa piso', causas: 'Falta de descrição do procedimento correto', acoes: 'Confeccionar um documento com procedimento correto', responsaveis: 'Matheus Alves e Fernanda Ponsoni', acoes_finalizadas: 'SIM', responsavel_analise: 'FERNANDA PONSONI', data_analise: '18/11/2025' },
  { numero_rac: '77', status_acoes: 'FINALIZADAS', prazo: '30/09/2025', situacao_final: 'EFICAZ', data_emissao: '22/09/2025', emitente: 'Fernanda Ponsoni', numero_nc: '930', processos_envolvidos: 'QUALIDADE', falha: 'Viga apresentando trinca ao longo do comprimento de todas as peças', causas: 'Falta de conferência mais rígida no recebimento, falta de procedimento de conferência', acoes: 'Criar procedimento de recebimento de vigas, efetuar acompanhamento rigoroso pelo controle de qualidade e líder do almoxarifado', responsaveis: 'Fernanda Ponsoni', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '31/10/2025' },
  { numero_rac: '78', status_acoes: 'FINALIZADAS', prazo: '30/10/2025', situacao_final: 'EFICAZ', data_emissao: '26/09/2025', emitente: 'Matheus Alves', numero_nc: '955', processos_envolvidos: 'PRODUÇÃO', falha: 'Vigas apresentando desvio no esquadro do corte', causas: 'Falta de ajuste de máquina, guias da corte frouxas ou desalinhadas, falha no posicionamento da viga', acoes: 'Ajuste de máquina de corte e posicionamento de viga', responsaveis: 'João Jersak', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '05/11/2025' },
  { numero_rac: '79', status_acoes: 'FINALIZADAS', prazo: '14/10/2025', situacao_final: 'EFICAZ', data_emissao: '10/10/2025', emitente: 'Fernanda Ponsoni', numero_nc: '959', processos_envolvidos: 'PRODUÇÃO', falha: 'Vigas de união montadas com divergência de distância em relação ao projeto', causas: 'Falta de atenção na leitura da cota do projeto, falha humana, posição da cota com relação ao desenho', acoes: 'Orientar o montador a ter mais atenção no momento de verificação das cotas', responsaveis: 'Adriano Santos', acoes_finalizadas: 'SIM', responsavel_analise: 'FERNANDA PONSONI', data_analise: '05/11/2025' },
  { numero_rac: '80', status_acoes: 'ATRASADA', prazo: '10/11/2025', situacao_final: '', data_emissao: '10/10/2025', emitente: 'Matheus', numero_nc: '956/961/965/968', processos_envolvidos: 'PCP, PRODUÇÃO', falha: 'Furação no desenho com 18 mm e na peça com 22 e 24 mm', causas: 'Divergência entre projeto e plano de corte, peças obsoletas misturadas, erro nos parâmetros de corte', acoes: 'Conferência entre planos de corte e projetos da engenharia, inventariar estoque de peças fabricadas, verificação dos parâmetros do laser', responsaveis: 'Rafael Lara, Cristiano Pereira', acoes_finalizadas: '', responsavel_analise: '', data_analise: '' },
  { numero_rac: '81', status_acoes: 'EM ANDAMENTO', prazo: '16/01/2026', situacao_final: '', data_emissao: '14/10/2025', emitente: 'Fernanda Ponsoni', numero_nc: '986 e 988', processos_envolvidos: 'PRODUÇÃO, FATURAMENTO E EXPEDIÇÃO, QUALIDADE', falha: 'Calhas e rampas sem identificação (identificação foi removida), trocadas no momento do carregamento, peças misturadas', causas: 'Falhas no controle e organização, falha humana, falta de planejamento', acoes: 'Padronizar método de identificação, implantar controle visual na área de expedição, treinar equipe, programar carregamento com antecedência', responsaveis: 'Ricardo Adamczyk; Cristiano Pereira; Rosana', acoes_finalizadas: '', responsavel_analise: '', data_analise: '' },
  { numero_rac: '82', status_acoes: 'ATRASADA', prazo: '21/11/2025', situacao_final: '', data_emissao: '04/11/2025', emitente: 'Fernanda Ponsoni', numero_nc: '1010', processos_envolvidos: 'PRODUÇÃO', falha: 'Bucha de articulação soltou-se no momento da montagem do pino', causas: 'Falta de aderência na solda, falha operacional', acoes: 'Orientar o soldador quanto ao procedimento correto de soldagem da bucha', responsaveis: 'Gilberto', acoes_finalizadas: '', responsavel_analise: '', data_analise: '' },
  { numero_rac: '83', status_acoes: 'ATRASADA', prazo: '21/11/2025', situacao_final: '', data_emissao: '04/11/2025', emitente: 'Fernanda Ponsoni', numero_nc: '1011', processos_envolvidos: 'ENGENHARIA, PCP, PRODUÇÃO', falha: 'Peças no plano de corte sem a furação', causas: 'Desenho técnico sem furações, informação não transmitida corretamente, operador selecionou programa errado', acoes: 'Revisar processo de preparação do programa, garantir controle de revisões, treinar operadores', responsaveis: 'Rafael Lara e Cristiano Pereira', acoes_finalizadas: '', responsavel_analise: '', data_analise: '' },
  { numero_rac: '84', status_acoes: 'ATRASADA', prazo: '28/11/2025', situacao_final: '', data_emissao: '11/11/2025', emitente: 'Fernanda Ponsoni', numero_nc: '1023, 1024 e 1025', processos_envolvidos: 'PRODUÇÃO', falha: 'Flanges descentralizados', causas: 'Problemas de fabricação das peças, problemas no processo de montagem, problemas de controle e inspeção', acoes: 'Revisar e calibrar dispositivos de furação e corte, implementar verificação dimensional antes da montagem, treinar operadores, fazer aferição dos gabaritos', responsaveis: 'Cristiano Pereira e Gilberto', acoes_finalizadas: '', responsavel_analise: '', data_analise: '' },
  { numero_rac: '85', status_acoes: 'FINALIZADAS', prazo: '18/11/2025', situacao_final: 'EFICAZ', data_emissao: '18/11/2025', emitente: 'Fernanda Ponsoni', numero_nc: '1041', processos_envolvidos: 'PRODUÇÃO, QUALIDADE', falha: 'Lança do coletor torta', causas: 'Gabarito com folga', acoes: 'Ajuste do gabarito', responsaveis: 'Fernanda Ponsoni e Marcos Kovaleski', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '28/11/2025' },
  { numero_rac: '86', status_acoes: 'EM ANDAMENTO', prazo: '18/12/2025', situacao_final: '', data_emissao: '25/11/2025', emitente: 'Fernanda Ponsoni', numero_nc: '1042', processos_envolvidos: 'PRODUÇÃO', falha: 'Armazenamento inadequado de chapas', causas: 'Organização física inadequada, layout mal planejado, falta de racks apropriados', acoes: 'Definir altura máxima de empilhamento, usar calços ou espaçadores, segregar chapas inteiras de chapas já usadas', responsaveis: 'Cristiano Pereira e Ricardo Adamczyk', acoes_finalizadas: '', responsavel_analise: '', data_analise: '' },
  { numero_rac: '87', status_acoes: 'EM ANDAMENTO', prazo: '18/12/2025', situacao_final: '', data_emissao: '03/12/2025', emitente: 'Fernanda Ponsoni', numero_nc: '1056', processos_envolvidos: 'QUALIDADE', falha: 'Rolamentos prensados', causas: 'Falha de montagem', acoes: 'Montar um checklist para avaliação da montagem', responsaveis: 'Fernanda Ponsoni e Matheus Alves', acoes_finalizadas: '', responsavel_analise: '', data_analise: '' },
  { numero_rac: '88', status_acoes: 'FINALIZADAS', prazo: '03/12/2025', situacao_final: 'EFICAZ', data_emissao: '03/12/2025', emitente: 'Fernanda Ponsoni', numero_nc: '1051', processos_envolvidos: 'ENGENHARIA', falha: 'Peças menores, não encaixam no parafuso', causas: 'Erro de projeto', acoes: 'Ajustado o projeto em 2 mm maiores a furação', responsaveis: 'Renato Sczcepanik', acoes_finalizadas: 'SIM', responsavel_analise: 'Fernanda Ponsoni', data_analise: '08/12/2025' },
  { numero_rac: '89', status_acoes: 'EM ANDAMENTO', prazo: '30/01/2026', situacao_final: '', data_emissao: '03/12/2025', emitente: 'Fernanda Ponsoni', numero_nc: '1047', processos_envolvidos: 'ENGENHARIA, PCP, PRODUÇÃO', falha: 'Medida do pilar errada, com 200 mm maior e pilar virado na montagem e solda', causas: 'Falha no processo de produção das peças, desenho com informações insuficientes, falha humana', acoes: 'Revisar os planos de corte da peça, orientar a equipe de separação de peças montagem e solda, revisar desenho/montagem e acrescentar marcação clara', responsaveis: 'Cristiano Pereira; Rafael Lara; Rodrigo Sbruzzi', acoes_finalizadas: '', responsavel_analise: '', data_analise: '' },
  { numero_rac: '90', status_acoes: 'EM ANDAMENTO', prazo: '30/01/2026', situacao_final: '', data_emissao: '17/12/2025', emitente: 'Fernanda Ponsoni', numero_nc: 'NA', processos_envolvidos: 'QUALIDADE', falha: 'Indicador de não conformidades acima da meta', causas: 'Falta de padronização dos processos, treinamento insuficiente, falhas na comunicação, planejamento inadequado, análise de causa raiz superficial, manutenção inadequada', acoes: 'Revisar e padronizar POPs, realizar treinamento inicial e reciclagem, aplicar análise de causa raiz estruturada, validar critérios de medição, garantir calibração e manutenção preventiva, avaliar fornecedores', responsaveis: 'Márcia Pili e Fernanda Ponsoni', acoes_finalizadas: '', responsavel_analise: '', data_analise: '' },
  { numero_rac: '91', status_acoes: 'EM ANDAMENTO', prazo: '30/01/2026', situacao_final: '', data_emissao: '17/12/2025', emitente: 'Matheus Alves', numero_nc: 'NA', processos_envolvidos: 'QUALIDADE', falha: 'Número de peças não conformes excedendo os limites estipulados pelas metas', causas: 'Falhas de processo, capacitação insuficiente, problemas em máquinas, matéria-prima fora de especificação, pressão por prazo, metas mal definidas', acoes: 'Realizar treinamento prático focado nos defeitos mais recorrentes, reforçar plano de manutenção preventiva, implementar avaliação periódica de desempenho de fornecedores', responsaveis: 'Márcia Pili e Fernanda Ponsoni', acoes_finalizadas: '', responsavel_analise: '', data_analise: '' },
  { numero_rac: '92', status_acoes: 'EM ANDAMENTO', prazo: '30/01/2026', situacao_final: '', data_emissao: '17/12/2025', emitente: 'Matheus Alves', numero_nc: 'NA', processos_envolvidos: 'PCP, ALMOXARIFADO', falha: 'Nível de acuracidade abaixo da meta estipulada', causas: 'Erros nos processos de recebimento, falhas no endereçamento, erros de movimentação interna, alta rotatividade de funcionários', acoes: 'Revisar e padronizar endereçamento físico e sistêmico, proibir armazenagem fora do endereço cadastrado, definir responsáveis por movimentação, criar bloqueio para movimentações sem autorização', responsaveis: 'Márcia Pili e Cristiane Cardoso', acoes_finalizadas: '', responsavel_analise: '', data_analise: '' },
  { numero_rac: '93', status_acoes: 'EM ANDAMENTO', prazo: '16/01/2025', situacao_final: '', data_emissao: '05/01/2026', emitente: 'Fernanda Ponsoni', numero_nc: '1079 e 1080', processos_envolvidos: 'PCP, COMPRAS', falha: 'Várias peças com dobra apresentando rachaduras no local da dobra que havia a marcação do código', causas: 'Concentração de tensão na gravação, gravação profunda demais, código gravado em área crítica, material com baixa ductilidade', acoes: 'Proibir gravação a laser na região de dobra, reposicionar o código para áreas planas, reduzir profundidade da gravação, avaliar sentido de dobra em relação à laminação, notificar o fornecedor', responsaveis: 'Rafael Lara, Cristiano Pereira e Cristiane Bandiera', acoes_finalizadas: '', responsavel_analise: '', data_analise: '' }
];

function parseDate(dateStr) {
  if (!dateStr || dateStr === '' || dateStr === '-' || dateStr === 'N/A') return null;
  const parts = dateStr.toString().split('/');
  if (parts.length === 3) {
    const [day, month, year] = parts;
    const fullYear = year.length === 2 ? `20${year}` : year;
    return `${fullYear}-${month.padStart(2, '0')}-${day.padStart(2, '0')}`;
  }
  return null;
}

function mapStatus(status) {
  if (!status) return 'ABERTA';
  const s = status.toString().toUpperCase().trim();
  if (s.includes('FINALIZADA') || s.includes('FINALIZADAS') || s.includes('CONCLU')) {
    return 'FECHADA';
  }
  if (s.includes('ANDAMENTO') || s.includes('EM CURSO')) {
    return 'EM_ANDAMENTO';
  }
  if (s.includes('VERIFICAÇÃO') || s.includes('VERIFICACAO') || s.includes('AGUARDANDO')) {
    return 'AGUARDANDO_VERIFICACAO';
  }
  if (s.includes('ATRASADA') || s.includes('PENDENTE')) {
    return 'ABERTA';
  }
  return 'ABERTA';
}

function mapOrigemTipo(processos, ncRelacionada) {
  if (ncRelacionada && ncRelacionada.trim() !== '' && ncRelacionada !== '-' && ncRelacionada !== 'NA') {
    return 'NAO_CONFORMIDADE';
  }
  if (processos) {
    const p = processos.toString().toLowerCase();
    if (p.includes('audit')) return 'AUDITORIA';
    if (p.includes('cliente') || p.includes('reclamação')) return 'RECLAMACAO';
  }
  return 'OUTRO';
}

function mapEficacia(situacaoFinal) {
  if (!situacaoFinal) return null;
  const s = situacaoFinal.toString().toUpperCase().trim();
  if (s === 'EFICAZ') return true;
  if (s.includes('NÃO') || s.includes('NAO')) return false;
  if (s.includes('PARCIAL')) return null;
  return null;
}

async function importAcoesCorretivas() {
  const client = await pool.connect();

  try {
    console.log('Iniciando importação de ações corretivas...');
    console.log(`Total de registros a importar: ${acoesCorretivas.length}`);

    // Verificar se a sequência existe, se não criar
    try {
      await client.query("SELECT nextval('seq_acao_corretiva')");
    } catch (e) {
      console.log('Criando sequência seq_acao_corretiva...');
      await client.query("CREATE SEQUENCE IF NOT EXISTS seq_acao_corretiva START 1");
    }

    // Reset da sequência
    await client.query("SELECT setval('seq_acao_corretiva', 1, false)");

    let importados = 0;
    let erros = 0;

    for (const rac of acoesCorretivas) {
      try {
        await client.query('BEGIN');

        const dataEmissao = parseDate(rac.data_emissao);
        const year = dataEmissao ? dataEmissao.split('-')[0] : new Date().getFullYear();
        const racNum = rac.numero_rac.toString().padStart(4, '0');
        const numero = `RAC-${year}-${racNum}`;

        const status = mapStatus(rac.status_acoes);
        const origemTipo = mapOrigemTipo(rac.processos_envolvidos, rac.numero_nc);
        const eficaz = mapEficacia(rac.situacao_final);

        let acoes = null;
        if (rac.acoes && rac.acoes.trim() !== '') {
          acoes = [{
            id: '1',
            descricao: rac.acoes.substring(0, 2000),
            responsavel: rac.responsaveis || 'Não definido',
            prazo: parseDate(rac.prazo) || new Date().toISOString().split('T')[0],
            status: status === 'FECHADA' ? 'CONCLUIDA' : 'EM_ANDAMENTO',
            data_conclusao: status === 'FECHADA' ? parseDate(rac.data_analise) : null,
            observacoes: null
          }];
        }

        await client.query(`
          INSERT INTO acoes_corretivas (
            numero, data_abertura, origem_tipo, origem_descricao,
            descricao_problema, analise_causa_raiz, causa_raiz_identificada,
            acoes, responsavel_principal, prazo_conclusao, data_conclusao,
            verificacao_eficacia, data_verificacao, responsavel_verificacao,
            acao_eficaz, status, created, updated
          ) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18)
        `, [
          numero,
          dataEmissao || new Date().toISOString().split('T')[0],
          origemTipo,
          rac.numero_nc || rac.processos_envolvidos || null,
          rac.falha || 'Não especificado',
          rac.causas || null,
          rac.causas || null,
          acoes ? JSON.stringify(acoes) : null,
          rac.responsaveis || rac.emitente || null,
          parseDate(rac.prazo) || null,
          status === 'FECHADA' ? parseDate(rac.data_analise) || new Date().toISOString() : null,
          rac.situacao_final || null,
          status === 'FECHADA' ? parseDate(rac.data_analise) : null,
          rac.responsavel_analise || null,
          eficaz,
          status,
          new Date().toISOString(),
          new Date().toISOString()
        ]);

        await client.query('COMMIT');
        importados++;
        console.log(`[${importados}/${acoesCorretivas.length}] Importado: ${numero} - ${(rac.falha || '').substring(0, 50)}...`);

      } catch (error) {
        await client.query('ROLLBACK');
        erros++;
        console.error(`Erro ao importar RAC ${rac.numero_rac}:`, error.message);
      }
    }

    console.log('\n========================================');
    console.log('IMPORTAÇÃO CONCLUÍDA');
    console.log(`Total importados: ${importados}`);
    console.log(`Total de erros: ${erros}`);
    console.log('========================================\n');

  } catch (error) {
    console.error('Erro geral na importação:', error);
  } finally {
    client.release();
    await pool.end();
  }
}

importAcoesCorretivas();
